library(tidyverse)
library(vcd)
library(WVPlots)
library(gmodels)
library(tigris)
library(sf)
library(tmap)
library(rmapshaper)
SRO = GSS2018 |> select("SEX", "REGION", "OWNGUN") |> haven::zap_label()
View(SRO)
SRO = na.omit(SRO)
SRO2 = SRO[SRO$OWNGUN < 3, ]
SRO2$SEX = factor(SRO2$SEX, labels = c("Male", "female"))
SRO2$OWNGUN = factor(SRO2$OWNGUN, labels = c("Yes", "No"))
Reg = c("New England", "Middle Atlantice", "East North Central", "West North Central", "South Atlantic", "East South Central", "West South Central", "Mountain", "Pacific")
SRO2$CenDiv = factor(SRO2$REGION, labels = Reg)
View(SRO2)
summary(SRO2[, -2])
sts <- states() %>% filter(!STUSPS %in% c('HI', 'AK','PR','GU', 'VI', 'AS', 'MP'))
sts <- ms_filter_islands(sts, min_area = 12391399903)
View(sts)
div <- sts %>% 
  group_by(DIVISION) %>%
summarize()  
View(div)
plot(div)
ShadowPlot(SRO2, "SEX", "OWNGUN", title = "Gun Ownership by Gender")
ShadowPlot(SRO2, "CenDiv", "OWNGUN", title = "Gun Ownership by Census Divisions")
CrossTable(SRO2$CenDiv, SRO2$OWNGUN, prop.chisq = F, prop.t = F, prop.c = F)
PctGun = round((prop.table(table(SRO2$CenDiv, SRO2$OWNGUN), 1) *100), 1)
PctGun = cbind(Percent = PctGun[1:9], NAME = Reg[1:9])
MapPctGun = bind_cols(div, PctGun)
MapPctGun$Percent = as.numeric(MapPctGun$Percent)
tm_shape(MapPctGun) + tm_fill(col = "Percent", n = 2) + tm_borders("white") + tm_text(unique("NAME")) + tm_layout(title = "Gun ownership by \n Census Divisions", title.size = 1, title.position = c(0.7, "top"))
Result = chisq.test(SRO2$CenDiv, SRO2$OWNGUN)
Result
Result$stdres
OvR = table(SRO2$OWNGUN, SRO2$CenDiv)
assocstats(OvR)
